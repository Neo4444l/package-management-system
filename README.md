# 退回包裹管理系统

一个用于管理退回包裹上架、下架和退件的现代化Web应用。

## 功能模块

### ✅ 已完成

#### 1. 上架功能
  - 从库位管理中选择库位号
  - 输入包裹号并记录上架时间
  - 查看已上架包裹列表
  - 删除包裹记录
  - 导出数据为CSV格式

#### 2. 下架功能
  - 显示待下架运单（状态为"待下架"）
  - 按库位分类显示
  - 显示客服指令信息
  - 扫描或输入运单号进行匹配
  - 匹配成功后强提醒（声音+视觉）
  - 显示运单完整信息
  - 确认下架后标记为"已下架"（不删除数据）

#### 3. 退件看板
  
  **库位管理**
  - 添加和删除库位号
  - 批量选择库位
  - 生成和打印库位二维码
  - 库位创建时间记录
  
  **中心退回管理**
  - 查询所有运单记录
  - 双维度分类显示：
    - **状态维度**: 全部/在库内/待下架/已下架
    - **客服指令**: 重派/重派（新面单）/退回客户
  - 搜索功能（运单号/库位号）
  - 时间筛选（上架时间/下架时间/下达指令时间）
  - 批量选择运单
  - 指令下达（自动更新为待下架状态）
  - 运单详情管理（查看和删除）
  - 完整的时间记录（上架/下架/指令）

## 技术栈

- **前端框架**: React 18
- **路由**: React Router 6
- **构建工具**: Vite
- **数据存储**: LocalStorage（可升级为后端API）
- **样式**: 纯CSS（现代化渐变设计）

## 安装和运行

### 方法一：使用启动菜单（推荐）

1. **双击运行** `启动.bat`
2. 选择 `[1] 一键安装并启动`
3. 等待安装完成，浏览器会自动打开

### 方法二：手动命令行

1. **安装依赖**
```bash
npm install
```

2. **启动开发服务器**
```bash
npm run dev
```

应用将在 `http://localhost:3000` 自动打开。

3. **构建生产版本**
```bash
npm run build
```

## 使用说明

### 首次使用流程

1. **设置库位**
   - 首页点击"退件看板"
   - 进入"库位管理"
   - 添加库位号（如：A-01, A-02, B-01等）
   - （可选）选择库位并打印二维码

2. **开始上架**
   - 返回首页，点击"上架"
   - 选择库位号
   - 输入包裹号
   - 系统自动记录时间

3. **管理运单**
   - 进入"退件看板" → "中心退回管理"
   - 查看所有运单
   - 按状态分类查询
   - 下达指令（重派、退回客户等）

### 详细功能说明

#### 上架流程
1. 在首页点击"上架"模块
2. 选择库位号（从库位管理中预设的库位）
3. 点击"继续"进入包裹录入页面
4. 输入包裹号并点击"添加"
5. 系统自动记录包裹号和上架时间
6. 可随时查看、删除记录或导出数据

#### 库位管理流程
1. 在首页点击"退件看板"
2. 进入"库位管理"
3. 输入库位号并添加
4. 勾选需要打印的库位
5. 点击"打印二维码"生成可打印的二维码

#### 中心退回管理流程
1. 在退件看板中进入"中心退回管理"
2. 使用搜索框查找特定运单
3. 使用标签页按状态筛选
4. 选择需要处理的运单
5. 点击"指令下达"
6. 选择目标状态（重派/退回客户等）

## 数据存储

目前使用浏览器的 LocalStorage 存储数据，包括：

### 包裹数据 (packages)
- 包裹号
- 库位号
- 包裹状态（在库内/待下架/已下架）
- 客服指令（重派/重派（新面单）/退回客户）
- 上架时间
- 下架时间
- 下达指令时间
- 状态历史记录

数据格式示例：
```json
{
  "id": 1697123456789,
  "packageNumber": "PKG001",
  "location": "A-01",
  "packageStatus": "in-warehouse",
  "customerService": "re-dispatch",
  "shelvingTime": "2025-10-15T08:30:00.000Z",
  "shelvingTimeDisplay": "2025/10/15 16:30:00",
  "unshelvingTime": "2025-10-15T10:30:00.000Z",
  "unshelvingTimeDisplay": "2025/10/15 18:30:00",
  "instructionTime": "2025-10-15T09:00:00.000Z",
  "instructionTimeDisplay": "2025/10/15 17:00:00",
  "statusHistory": [
    {
      "action": "instruction",
      "customerService": "re-dispatch",
      "changedAt": "2025-10-15T09:00:00.000Z",
      "changedAtDisplay": "2025/10/15 17:00:00"
    }
  ]
}
```

### 库位数据 (locations)
- 库位号
- 创建时间

数据格式示例：
```json
{
  "id": 1697123456789,
  "code": "A-01",
  "createdAt": "2025-10-15T08:00:00.000Z",
  "createdAtDisplay": "2025/10/15 16:00:00"
}
```

### 运单状态说明

**包裹状态 (packageStatus):**
- `in-warehouse`: 在库内
- `pending-removal`: 待下架
- `removed`: 已下架

**客服指令 (customerService):**
- `re-dispatch`: 重派
- `re-dispatch-new-label`: 重派（新面单）
- `return-to-customer`: 退回客户

## 项目结构

```
退回包裹管理系统/
├── src/
│   ├── pages/
│   │   ├── HomePage.jsx                  # 首页 - 三大功能模块入口
│   │   ├── ShelvingPage.jsx              # 上架 - 库位选择页
│   │   ├── ShelvingInput.jsx             # 上架 - 包裹录入页
│   │   ├── UnshelvingPage.jsx            # 下架 - 运单扫描下架页
│   │   ├── ReturnDashboard.jsx           # 退件看板 - 主页
│   │   ├── LocationManagement.jsx        # 退件看板 - 库位管理
│   │   └── CenterReturnManagement.jsx    # 退件看板 - 中心退回管理
│   ├── App.jsx                           # 主应用和路由配置
│   ├── main.jsx                          # 入口文件
│   └── index.css                         # 全局样式
├── index.html
├── package.json
├── vite.config.js
├── 启动.bat                               # 启动菜单（包含所有功能）
├── 安装指南.txt                           # 安装说明文档
├── 使用教程.md                            # 详细使用教程
└── README.md
```

## 功能特性

✨ **现代化UI设计**
- 渐变色主题
- 流畅的动画效果
- 响应式布局，支持移动端

📋 **完善的状态管理**
- 运单状态跟踪
- 状态历史记录
- 批量状态更新

🔍 **强大的搜索和筛选**
- 实时搜索
- 多状态分类
- 快速定位运单

🖨️ **二维码打印**
- 批量生成二维码
- 大尺寸打印（15cm x 10cm标签）
- 二维码占60%面积，下方显示库位号
- 高容错率，易扫描
- 可直接打印或保存PDF

📊 **数据导出**
- CSV格式导出
- 包含完整信息
- 支持Excel打开

🔊 **智能提醒**
- 下架匹配成功声音提示
- 强视觉提醒（绿色高亮卡片）
- 关键信息突出显示

## 🌐 部署到互联网

### 快速部署到Vercel（5分钟完成）

本项目已配置好Vercel部署，可以让全世界都访问您的系统！

#### 方法一：使用启动菜单（最简单）

1. 双击运行 `启动.bat`
2. 选择 `[5] 🚀 部署到互联网（Vercel）`
3. 按照菜单提示操作

#### 方法二：查看详细教程

查看以下文档了解完整部署步骤：
- 📖 **🚀 开始部署.txt** - 快速开始指南
- 📖 **Vercel部署指南.md** - 详细图文教程
- 📖 **部署检查清单.md** - 逐步检查清单
- 📖 **后端集成指南.md** - 添加数据库教程

#### 部署后的优势

- ✅ 全球任何地方都可访问
- ✅ 自动HTTPS安全连接
- ✅ 免费CDN加速
- ✅ 自动部署更新
- ✅ 无需服务器维护

#### 数据共享方案

**当前版本（LocalStorage）：**
- 每个用户数据独立
- 适合个人使用

**升级方案（Supabase后端）：**
- 多人共享数据
- 云端存储
- 完全免费

详见：`后端集成指南.md`

---

## 后续改进建议

1. **后端集成**: 替换 LocalStorage 为真实的后端API和数据库 ⭐ 推荐使用Supabase
2. **用户认证**: 添加登录功能和权限管理
3. **数据同步**: 多设备数据同步
4. **高级搜索**: 时间范围筛选、批次查询
5. **统计报表**: 上架数量统计、时间分析、状态分布图
6. **扫码枪优化**: 更好的扫码枪支持和配置
7. **批量导入**: Excel批量导入运单信息
8. **通知系统**: 状态变更通知、异常提醒
9. **操作日志**: 记录所有操作历史，支持审计
10. **打印模板**: 自定义二维码标签打印模板

## License

MIT

